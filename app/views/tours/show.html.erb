<h2><%= @tour.name %></h2>
Tour stops:

<ul>
<% @stops.each do |stop| %>
  <li><%= stop.name %></li>
<% end %>
</ul>

<div id="map-canvas"></div>

<script type="text/javascript">

 function initialize() {
   var mapOptions = {
     center: { lat: <%= @stops.first.latitude %>, lng: <%= @stops.first.longitude %>},
     zoom: 14
   };

   var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

   <% @stops.each_with_index do |stop, i| %>
     var marker<%= i %> = new google.maps.Marker({
         position: new google.maps.LatLng(<%= stop.latitude %>, <%= stop.longitude %>),
         map: map,
     });

   var infowindow<%= i %> = new google.maps.InfoWindow({
     content: '<div> <%= stop.description %> </div>'
   });

    google.maps.event.addListener(marker<%= i %>, 'click', function() {
      infowindow<%= i %>.open(map, marker<%= i %>);
    });
    <% end %>
  }


 google.maps.event.addDomListener(window, 'load', initialize);

</script>
